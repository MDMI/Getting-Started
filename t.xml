
<foo>
	<datatypeMaps xmi:id="_txRJpaI_Eem3sI_lln0jxw"
		name="FHIR_ReferenceToInstanceIdentifier"
		fromMDMI="
function mapInstanceIdentifierToFHIR_Reference(source, target, properties, conversionrule) {

     
    var fhirResource = org.mdmi.core.engine.javascript.Utils.getSemanticProperyQualifier(conversionrule, 'fhirResource:');
    target.setValueSafely('reference.type', fhirResource);

    if (properties.get('REFERENCEURL') != null) {
        if (source.getValue('extension') != null) {
            target.setValueSafely('reference.value', properties.get('REFERENCEURL') + fhirResource +  source.getValue('extension'));
        }

        if (source.getValue('root') != null) {
            target.setValueSafely('reference.value', properties.get('REFERENCEURL') + fhirResource + source.getValue('root'));
        }
    } else {

        if (source.getValue('extension') != null &amp;&amp; source.getValue('root') != null) {
            target.setValueSafely('reference.value', properties.get('REFERENCEURL') + fhirResource +source.getValue('root') + '::' + source.getValue('extension'));
        } else {
            if (source.getValue('extension') != null) {
                target.setValueSafely('reference.value', properties.get('REFERENCEURL') + fhirResource +source.getValue('extension'));
            }

            if (source.getValue('root') != null) {
                target.setValueSafely('reference.value', properties.get('REFERENCEURL') + fhirResource +source.getValue('root'));
            }
        }



    }
}
		
		"
		toMDMI="function mapFHIR_ReferenceToInstanceIdentifier(s,t) { &#xA;    if (s.getValue(&quot;reference&quot;) != null) {&#xA;        var sc =  s.getValue(&quot;reference&quot;);&#xA;        if (sc.getValue(&quot;value&quot;) != null) {&#xA;            t.setValue(&quot;extension&quot;, sc.getValue(&quot;value&quot;));&#xA;        }&#xA;    }&#xA;}&#xA; " />
</foo>